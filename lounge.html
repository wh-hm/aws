<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>みえるか</title>
<link rel="stylesheet" href="css/reset.css">
<link rel="stylesheet" href="css/style.css">
<meta name="viewport" content="width=device-width,initial-scale=1">
</head>

<body>

	<header>
		<h1><a href="home.html">ロゴ</a></h1>
		
		<nav class="pc_nav">
			<ul>
				<li><a href="home.html">HOME</a></li>
				<li><a href="lounge.html">ラウンジ</a></li>
				<li><a href="maintenance.html">7階</a></li>
				<li><a href="maintenance.html">8階</a></li>
				<li><a href="maintenance.html">使い方</a></li>
				<li><a href="contact.html">お問い合わせ</a></li>
			</ul>
		</nav>
		
		<div class="openbtn"><span></span><span></span><span></span>	</div>
			<nav id="g-nav">
				<div class = "gnav_in">
			
					<ul>
						<li><a href="home.html">HOME</a></li>
						<li><a href="lounge.html">ラウンジ</a></li>
						<li><a href="maintenance.html">7階</a></li>
						<li><a href="maintenance.html">8階</a></li>
						<li><a href="maintenance.html">使い方</a></li>
						<li><a href="contact.html">お問い合わせ</a></li>
					</ul>
				</div>
			</nav>
	</header>
	
	<section id="lounge" class="main">
		<div class="w1">
			<h2>~ラウンジの状況~</h2>
			
			<div class="text"><a href="lounge_camera.html">現在の状況をカメラで見る</a></div>
			
			<div class="picture">
				<div class="sekiinfo">
				<div class="col2"><span class="true"></span>空席</div>
				<div class="col2"><span class="false"></span>満席</div>
				</div>
				<div class="col2">
					<div class="sofa">
						<div class="seki" id="seki1"></div>
						<div class="seki" id="seki2"></div>
						<div class="seki" id="seki3"></div>
						<div class="seki" id="seki4"></div><div class="seki" id="seki5"></div>
					</div>
					<div class="counter">
						<div class="seki" id="seki6"></div>
						<div class="seki" id="seki7"></div>
						<div class="seki" id="seki8"></div>
						<div class="seki" id="seki9"></div>
						<div class="seki" id="seki10"></div>
						<div class="seki" id="seki11"></div>
						<div class="seki" id="seki12"></div>
					</div>
				</div>
			<div class="sofachair">
				<div class="seki" id="seki13"></div>
				<div class="seki" id="seki14"></div>
				<div class="seki" id="seki15"></div>
				<div class="seki" id="seki16"></div>
			</div>
				<div class="col2 col3">
					<div></div>
					<div class="chair">
						<div class="seki" id="seki17"></div>
						<div class="seki" id="seki18"></div>
						<div class="seki" id="seki19"></div>
						<div class="seki" id="seki20"></div>
					</div>
					<div class="counter2">
						<div class="seki" id="seki21"></div>
						<div class="seki" id="seki22"></div>
						<div class="seki" id="seki23"></div>
						<div class="seki" id="seki24"></div>
						<div class="seki" id="seki25"></div>
					</div>
				</div>
				<div class="col2 else">
					<div></div>
					<div class="book">本棚</div>
					<div class="elevator">エレベータ</div>
				</div>
			
			
			</div>
			
			<div class="picture2">
				<div class="sekiinfo">
				<div class="col2"><span class="true"></span>空席</div>
				<div class="col2"><span class="false"></span>満席</div>
				</div>
				
				<div class="sofachair">
					<div class="seki" id="seki13_s"></div>
					<div class="seki" id="seki14_s"></div>
					<div class="seki" id="seki15_s"></div>
					<div class="seki" id="seki16_s"></div>
				</div>
				
				<div class="col">
					<div class="book">本棚</div>

					<div class="chair">
						<div class="seki" id="seki17_s"></div>
						<div class="seki" id="seki18_s"></div>
						<div class="seki" id="seki19_s"></div>
						<div class="seki" id="seki20_s"></div>
					</div>

					<div class="sofa">
						<div class="seki" id="seki1_s"></div>
						<div class="seki" id="seki2_s"></div>
						<div class="seki" id="seki3_s"></div>
						<div class="seki" id="seki4_s"></div><div class="seki" id="seki5_s"></div>
					</div>
				</div>
				<div class="col">
					<div class="elevator">エレベータ</div>
					<div class="counter2">
						<div class="seki" id="seki21_s"></div>
						<div class="seki" id="seki22_s"></div>
						<div class="seki" id="seki23_s"></div>
						<div class="seki" id="seki24_s"></div>
						<div class="seki" id="seki25_s"></div>
					</div>
					<div class="counter">
						<div class="seki" id="seki6_s"></div>
						<div class="seki" id="seki7_s"></div>
						<div class="seki" id="seki8_s"></div>
						<div class="seki" id="seki9_s"></div>
						<div class="seki" id="seki10_s"></div>
						<div class="seki" id="seki11_s"></div>
						<div class="seki" id="seki12_s"></div>
					</div>
				</div>
				

			</div>
			<div id="content">
					<div class="col2"><span id="blue"></span>ソファー</div>
					
					<div class="col2"><span id="purple"></span>ソファー＆椅子</div>
					<div class="col2"><span id="pink"></span>椅子</div>
					<div class="col2"><span id="yellow"></span>カウンター1</div>
					<div class="col2"><span id="green"></span>カウンター2</div>
				</div>
			<div class="info">
				<div class="col">
					<p>撮影時刻</p>
					<label id="date">20:20</label>
				</div>
				<div id="nowpeople">
					<p>現在のラウンジ人数</p>
					<div><label id="people">20</label></div>
					<p>人</p>
				</div>
				
				<div class="btn"><input type="button" value="更新" onClick="color()"></div>
				
				
			</div>
		</div>
	</section>
	
	
	<footer>
		<div><input type="button" value="ログアウト" onClick="logout()" id="logoutbtn"></div>
		<div class="col">
		<a href="https://www.nca.ac.jp/"><img src="images/school.png" alt="名古屋デザイン＆テクノロジー専門学校"></a>
		<small>© 2024 TeamNagoya All rights reserved.</small>
		</div>
	</footer>
	<script src="https://code.jquery.com/jquery-3.4.1.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="  crossorigin="anonymous"></script>
	<script src="js/5-2-1.js"></script>
    <script>
		window.onload = function(){
			let sesssin = sessionStorage.getItem('school_number');
			console.log(sesssin);
			if(sesssin == null){
				location.href = 'index.html';
			}
		}
		
	
		let school_number = sessionStorage.getItem('school_number');
		
		
		
		function logout(){
			sessionStorage.removeItem(school_number);
			location.href = "index.html";
		}
		var dt = new Date();
		let hours = dt.getHours();
		let minutes = dt.getMinutes();
		
		var date = document.getElementById("date");
	
		let yearmin = hours + ":" + minutes;
		
		date.innerHTML = yearmin;
			
        var apiUrl = 'https://fhjp15dj74.execute-api.ap-northeast-1.amazonaws.com/seki/gomi2';
		
        var opts = {
            mode: 'cors' // CORSを有効にする
        };
		
		var pepole;
		var sum;

        fetch(apiUrl, opts)
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
			
				
                return response.json();
            })
            .then(data => {
                // レスポンスを処理するコード
			
				people = data["people"];
				sum = data["sum"]
			
                console.log(people);
				console.log(sum);
				let sumpeople = document.getElementById("people");
	
				sumpeople.innerHTML = sum;
				
				for(let a = 0; a < 24; a ++){
				
				let name = "seki" + (a + 1);
				let name2 = name + "_s";
				let id = document.getElementById(name);
				let id2 = document.getElementById(name2);
				if(people[a] == 0){
					
					id.className = "seki";
					id2.className = "seki";
				}else{
					id.className = "seki2";
					id2.className = "seki2";
				}
				
			}
            })
            .catch(error => {
                // エラー処理
                console.error('There was a problem with the fetch operation:', error);
            });
		
		function color() {
			
			fetch(apiUrl, opts)
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
			
				
                return response.json();
            })
            .then(data => {
                // レスポンスを処理するコード
				people = data["people"];
				sum = data["sum"]
			
                console.log(people);
				console.log(sum);
				let sumpeople = document.getElementById("people");
				sumpeople.innerHTML = sum;
				
				for(let a = 0; a < 24; a ++){
				
				let name = "seki" + (a + 1);
				let name2 = name + "_s";
				let id = document.getElementById(name);
				let id2 = document.getElementById(name2);
				if(people[a] == 0){
					
					id.className = "seki";
					id2.className = "seki";
				}else{
					id.className = "seki2";
					id2.className = "seki2";
				}
				
			}
                console.log(people);
				console.log(sum);
            })
            .catch(error => {
                // エラー処理
                console.error('There was a problem with the fetch operation:', error);
            });
			
           	
        }
    </script>
	
</body>
</html>
